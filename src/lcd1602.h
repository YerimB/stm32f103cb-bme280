#ifndef LCD1602_H
#define LCD1602_H

#include "i2c.h"
#include "clock.h"
#include "result.h"

#define LCD1602_I2C_ADDR 0x27

#define LCD1602_RS_CMD 0x00
#define LCD1602_RS_DATA 0x01
#define LCD1602_RW_WRITE 0x00
#define LCD1602_RW_READ 0x02
#define LCD1602_E_ENABLE 0x04
#define LCD1602_E_DISABLE 0x00
#define LCD1602_BACKLIGHT_ON 0x08
#define LCD1602_BACKLIGHT_OFF 0x00

#define LCD1602_CMD_CLEAR_DISPLAY 0x01
#define LCD1602_CMD_RETURN_HOME 0x02
// Entry mode
#define LCD1602_CMD_ENTRY_MODE_SET_CTRL 0x04
#define LCD1602_CMD_ENTRY_MODE_SET_DECREMENT LCD1602_CMD_ENTRY_MODE_SET_CTRL
#define LCD1602_CMD_ENTRY_MODE_SET_INCREMENT (LCD1602_CMD_ENTRY_MODE_SET_CTRL | 0x02)
#define LCD1602_CMD_ENTRY_MODE_SET_SHIFT_OFF LCD1602_CMD_ENTRY_MODE_SET_CTRL
#define LCD1602_CMD_ENTRY_MODE_SET_SHIFT_ON (LCD1602_CMD_ENTRY_MODE_SET_CTRL | 0x01)
// Display on/off control
#define LCD1602_CMD_DISPLAY_CTRL 0x08
#define LCD1602_CMD_DISPLAY_OFF LCD1602_CMD_DISPLAY_CTRL
#define LCD1602_CMD_DISPLAY_ON (LCD1602_CMD_DISPLAY_CTRL | 0x04)
#define LCD1602_CMD_CURSOR_OFF LCD1602_CMD_DISPLAY_CTRL
#define LCD1602_CMD_CURSOR_ON (LCD1602_CMD_DISPLAY_CTRL | 0x06)
#define LCD1602_CMD_BLINK_OFF LCD1602_CMD_DISPLAY_CTRL
#define LCD1602_CMD_BLINK_ON (LCD1602_CMD_DISPLAY_CTRL | 0x05)
// Function set
#define LCD1602_CMD_FN_SET_CTRL 0x20
#define LCD1602_CMD_FN_SET_4_BIT LCD1602_CMD_FN_SET_CTRL
#define LCD1602_CMD_FN_SET_8_BIT (LCD1602_CMD_FN_SET_CTRL | 0x10)
#define LCD1602_CMD_FN_SET_1_LINE LCD1602_CMD_FN_SET_CTRL
#define LCD1602_CMD_FN_SET_2_LINES (LCD1602_CMD_FN_SET_CTRL | 0x08)
#define LCD1602_CMD_FN_SET_5x8_DOTS LCD1602_CMD_FN_SET_CTRL
#define LCD1602_CMD_FN_SET_5x10_DOTS (LCD1602_CMD_FN_SET_CTRL | 0x04)

void lcd1602_set_i2c_instance(I2C_TypeDef *i2c_instance);
Result lcd1602_send_cmd(const uint8_t cmd);
Result lcd1602_send_data(char data);
Result lcd1602_set_backlight(const uint8_t state);
Result lcd1602_clear(void);
Result lcd1602_put_cursor(uint8_t row, uint8_t col);
Result lcd1602_put_str(const char *str);
Result lcd1602_put_int(int32_t n);
Result lcd1602_init(void);

#endif // LCD1602_H
